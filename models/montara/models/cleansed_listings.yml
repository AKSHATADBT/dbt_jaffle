version: 2
models:
  - name: cleansed_listings
    description: ""
    config:
      materialized: incremental
      unique_key:
        - id
      incremental_strategy: merge
    columns:
      - name: created_at
        type: TIMESTAMP
        tests:
          - not_null_tolerance:
              tolerance: 4
          - unique_tolerance:
              tolerance: 4
          - date_range_tolerance:
              range_type: Between
              after: 2024-4-16
              before: 2024-4-18
              tolerance: 1
        description: ""
      - name: host_id
        type: NUMBER
        tests:
          - not_null_tolerance:
              tolerance: 0
          - range_tolerance:
              min: 0
              max: 7
              tolerance: 0
        description: ""
      - name: room_type
        type: TEXT
        tests: []
        description: ""
      - name: id
        type: NUMBER
        tests:
          - unique_tolerance:
              tolerance: 0
        description: ""
      - name: price
        type: TEXT
        tests: []
        description: ""
      - name: name
        description: The name or title of the listing as provided by the host.
        type: TEXT
        tests:
          - accepted_values_tolerance:
              value:
                - teset
                - test
                - asdf
                - fff
              tolerance: 0
      - name: updated_at
        type: TIMESTAMP
        tests: []
        description: ""
      - name: listing_url
        description: The URL linking directly to the listing's webpage.
        type: TEXT
        tests: []
      - name: minimum_nights
        description: The minimum number of nights a guest must book the listing for.
        type: NUMBER
        tests: []
    meta:
      incremental_column: updated_at
      model_tags:
        - 9a684041-cebe-4a73-a4a2-f454d305813e
      warehouse_type: snowflake
    tests:
      - new_custom_validation__cleansed_listings__
