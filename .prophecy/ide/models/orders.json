{"id":"orders","metainfo":{"label":"orders","autoLayout":true,"staleState":"none","sourceSuggestions":{"sources":[]},"graphConfig":{"userDefinedConfig":{"vars":{"payment_methods":"['credit_card', 'coupon', 'bank_transfer', 'gift_card']"}}}},"processes":{"order_payments##bxfIgv4Q":{"id":"order_payments##bxfIgv4Q","component":"Aggregate","metadata":{"label":"order_payments","phase":0,"macroDependencies":[]},"properties":{"aggregate":[{"expression":{"expression":"order_id"}},{"rowType":"for","variable":{"expression":"payment_method"},"iterable":{"expression":"payment_methods"},"children":[{"expression":{"expression":"sum(CASE\n  WHEN payment_method = '{{ payment_method }}'\n    THEN amount\n  ELSE 0\nEND)"},"alias":"{{payment_method}}_amount"}]},{"expression":{"expression":"sum(amount)"},"alias":"total_amount"}],"allowSelection":true,"condition":{"expression":""},"activeTab":"aggregate","columnsSelector":[],"groupBy":[{"expression":{"expression":"order_id"}}]},"ports":{"inputs":[{"id":"e7xxX5ch","slug":"payments"}],"outputs":[{"id":"imiu4Evo","slug":"out"}],"isCustomOutputSchema":false}},"payments##MXfBxJjY":{"id":"payments##MXfBxJjY","component":"Model","metadata":{"label":"payments","phase":0},"properties":{"table":{"name":"stg_payments","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"IwZau8OZ","slug":"out"}],"isCustomOutputSchema":false}},"orders##QGiflw0v":{"id":"orders##QGiflw0v","component":"TargetModel","metadata":{"label":"orders","phase":0,"macroDependencies":[]},"properties":{"customQueryDisabled":true,"customQuery":false,"incrementalEditorDisabled":true,"query":"SELECT * \n\nFROM final\n","incrementalKey":false,"incremental":{"expression":"true"}},"ports":{"inputs":[{"id":"hhohIMmX","slug":"final"}],"outputs":[{"id":"wKqtF3I2","slug":"out"}],"isCustomOutputSchema":false}},"orders##gcW5B64k":{"id":"orders##gcW5B64k","component":"Model","metadata":{"label":"orders","phase":0},"properties":{"table":{"name":"stg_orders","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"CYFT1C4o","slug":"out"}],"isCustomOutputSchema":false}},"final##WFZkkKeN":{"id":"final##WFZkkKeN","component":"Join","metadata":{"label":"final","phase":0,"macroDependencies":[]},"properties":{"conditions":[{"alias":"order_payments","expression":{"expression":"orders.order_id = order_payments.order_id"},"joinType":"LEFT"}],"expressions":[{"expression":{"expression":"orders.order_id"}},{"expression":{"expression":"orders.customer_id"}},{"expression":{"expression":"orders.order_date"}},{"expression":{"expression":"orders.status"}},{"expression":{"expression":"order_payments.credit_card_amount"}},{"expression":{"expression":"order_payments.coupon_amount"}},{"expression":{"expression":"order_payments.bank_transfer_amount"}},{"expression":{"expression":"order_payments.gift_card_amount"}},{"expression":{"expression":"order_payments.total_amount"},"alias":"amount"}],"activeTab":"conditions","columnsSelector":[],"headAlias":"orders"},"ports":{"inputs":[{"id":"zot2FUQR","slug":"orders"},{"id":"ofNhdLr3","slug":"order_payments"}],"outputs":[{"id":"qLO0xs2a","slug":"out"}],"isCustomOutputSchema":false}}},"connections":[{"id":"I1OPImD8","source":"payments##MXfBxJjY","sourcePort":"IwZau8OZ","target":"order_payments##bxfIgv4Q","targetPort":"e7xxX5ch"},{"id":"lcq28w7O","source":"orders##gcW5B64k","sourcePort":"CYFT1C4o","target":"final##WFZkkKeN","targetPort":"zot2FUQR"},{"id":"YKXxbjiE","source":"order_payments##bxfIgv4Q","sourcePort":"imiu4Evo","target":"final##WFZkkKeN","targetPort":"ofNhdLr3"},{"id":"sXzh0OhY","source":"final##WFZkkKeN","sourcePort":"qLO0xs2a","target":"orders##QGiflw0v","targetPort":"hhohIMmX"}],"component":"Model"}