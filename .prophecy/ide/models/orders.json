{"id":"orders","metainfo":{"label":"orders","finalProcessID":"final##CkS8ybZ1","autoLayout":true,"staleState":"none","sourceSuggestions":{"sources":[]},"graphConfig":{"userDefinedConfig":{"vars":{"payment_methods":"['credit_card', 'coupon', 'bank_transfer', 'gift_card']"}}}},"processes":{"orders##Z88n8c4Z":{"id":"orders##Z88n8c4Z","component":"Model","metadata":{"label":"orders","phase":0,"macroDependencies":[]},"properties":{"table":{"name":"stg_orders","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"XcOiyolX","slug":"out"}],"isCustomOutputSchema":false}},"payments##fWwVCkcB":{"id":"payments##fWwVCkcB","component":"Model","metadata":{"label":"payments","phase":0,"macroDependencies":[]},"properties":{"table":{"name":"stg_payments","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"oCLAfGnc","slug":"out"}],"isCustomOutputSchema":false}},"order_payments##9t6pGiPq":{"id":"order_payments##9t6pGiPq","component":"Aggregate","metadata":{"label":"order_payments","phase":0,"macroDependencies":[]},"properties":{"aggregate":[{"expression":{"expression":"order_id"}},{"rowType":"for","variable":{"expression":"payment_method"},"iterable":{"expression":"payment_methods"},"children":[{"expression":{"expression":"sum(CASE WHEN payment_method = '{{ payment_method }}' THEN amount ELSE 0 END)"},"alias":"{{payment_method}}_amount"}]},{"expression":{"expression":"sum(amount)"},"alias":"total_amount"}],"allowSelection":true,"activeTab":"aggregate","columnsSelector":[],"groupBy":[{"expression":{"expression":"order_id"}}]},"ports":{"inputs":[{"id":"sSIXeKOF","slug":"payments"}],"outputs":[{"id":"YzIZg3We","slug":"out"}],"isCustomOutputSchema":false}},"final##CkS8ybZ1":{"id":"final##CkS8ybZ1","component":"Join","metadata":{"label":"final","phase":0,"macroDependencies":[]},"properties":{"conditions":[{"alias":"order_payments","expression":{"expression":"orders.order_id = order_payments.order_id"},"joinType":"LEFT"}],"expressions":[{"expression":{"expression":"orders.order_id"}},{"expression":{"expression":"orders.customer_id"}},{"expression":{"expression":"orders.order_date"}},{"expression":{"expression":"orders.status"}},{"expression":{"expression":"order_payments.credit_card_amount"}},{"expression":{"expression":"order_payments.coupon_amount"}},{"expression":{"expression":"order_payments.bank_transfer_amount"}},{"expression":{"expression":"order_payments.gift_card_amount"}},{"expression":{"expression":"order_payments.total_amount"},"alias":"amount"}],"activeTab":"conditions","columnsSelector":[],"headAlias":"orders"},"ports":{"inputs":[{"id":"mogr7syx","slug":"orders"},{"id":"IaN8yQ8q","slug":"order_payments"}],"outputs":[{"id":"Y4aQvb2n","slug":"out"}],"isCustomOutputSchema":false}}},"connections":[{"id":"y9dKf4Rz","source":"payments##fWwVCkcB","sourcePort":"oCLAfGnc","target":"order_payments##9t6pGiPq","targetPort":"sSIXeKOF"},{"id":"4XXibQsi","source":"orders##Z88n8c4Z","sourcePort":"XcOiyolX","target":"final##CkS8ybZ1","targetPort":"mogr7syx"},{"id":"o8rAdHxV","source":"order_payments##9t6pGiPq","sourcePort":"YzIZg3We","target":"final##CkS8ybZ1","targetPort":"IaN8yQ8q"}],"component":"Model"}