{"id":"customer_report","metainfo":{"label":"customer_report","finalProcessID":"Dd1OrW679GOSItNBX-GOY$$NWBogC9dQmSdoAoxs5Ot-","autoLayout":false,"staleState":"none","sourceSuggestions":{"sources":[]}},"processes":{"XDWCVKTc2tGc_ZEZ5EJ9l":{"id":"XDWCVKTc2tGc_ZEZ5EJ9l","component":"Source","metadata":{"label":"CUSTOMERS","slug":"CUSTOMERS","x":120,"y":120,"phase":0},"properties":{"table":{"name":"CUSTOMERS","sourceType":"Source","sourceName":"JAFFLE_SHOP.public","alias":"","additionalProperties":null}},"ports":{"inputs":[],"outputs":[{"id":"XCR3bpAElE7050s7VOXZx","schema":{"providerType":"Snowflake","fields":[{"name":"CUSTOMER_ID","dataType":{"type":"Number"}},{"name":"FIRST_NAME","dataType":{"type":"String"}},{"name":"LAST_NAME","dataType":{"type":"String"}},{"name":"FIRST_ORDER","dataType":{"type":"Date"}},{"name":"MOST_RECENT_ORDER","dataType":{"type":"Date"}},{"name":"NUMBER_OF_ORDERS","dataType":{"type":"Number"}},{"name":"CUSTOMER_LIFETIME_VALUE","dataType":{"type":"Number"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"CI6hud1qAjis4uHAlURlY":{"id":"CI6hud1qAjis4uHAlURlY","component":"Source","metadata":{"label":"ORDERS","slug":"ORDERS","x":120,"y":320,"phase":0},"properties":{"table":{"name":"ORDERS","sourceType":"Source","sourceName":"JAFFLE_SHOP.public","alias":"","additionalProperties":null}},"ports":{"inputs":[],"outputs":[{"id":"nFIZ6k2uj_lwIyvHcvauG","schema":{"providerType":"Snowflake","fields":[{"name":"ORDER_ID","dataType":{"type":"Number"}},{"name":"CUSTOMER_ID","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}},{"name":"STATUS","dataType":{"type":"String"}},{"name":"CREDIT_CARD_AMOUNT","dataType":{"type":"Number"}},{"name":"COUPON_AMOUNT","dataType":{"type":"Number"}},{"name":"BANK_TRANSFER_AMOUNT","dataType":{"type":"Number"}},{"name":"GIFT_CARD_AMOUNT","dataType":{"type":"Number"}},{"name":"AMOUNT","dataType":{"type":"Number"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"VWRtaocXXlJ5zC4wfU4_9$$ZI_8qrBqPI-d6yZJvs_r1":{"id":"VWRtaocXXlJ5zC4wfU4_9$$ZI_8qrBqPI-d6yZJvs_r1","component":"Join","metadata":{"label":"UsingCustomerId","slug":"UsingCustomerId","x":340,"y":200,"phase":0,"macroDependencies":[]},"properties":{"conditions":[{"alias":"CUSTOMERS","expression":{"expression":"CUSTOMERS.CUSTOMER_ID = ORDERS.CUSTOMER_ID"},"joinType":"inner"}],"expressions":[{"expression":{"expression":"ORDERS.AMOUNT"},"alias":"AMOUNT"},{"expression":{"expression":"CUSTOMERS.CUSTOMER_ID"},"alias":"CUSTOMER_ID"},{"expression":{"expression":"ORDERS.ORDER_DATE"},"alias":"ORDER_DATE"}],"activeTab":"expressions","columnsSelector":["Fp4c9ib1g60lf9A8AxsQA$$_krT7e95lMUi6PmhvLu6I##CUSTOMER_ID","MyXMhyMtjt39XT9JlM0Hi$$FdT34X6KKgJyWLC0NWDnh##CUSTOMER_ID","MyXMhyMtjt39XT9JlM0Hi$$FdT34X6KKgJyWLC0NWDnh##AMOUNT","Fp4c9ib1g60lf9A8AxsQA$$_krT7e95lMUi6PmhvLu6I##CUSTOMER_ID","MyXMhyMtjt39XT9JlM0Hi$$FdT34X6KKgJyWLC0NWDnh##ORDER_DATE"],"headAlias":"CUSTOMERS"},"ports":{"inputs":[{"id":"Fp4c9ib1g60lf9A8AxsQA$$_krT7e95lMUi6PmhvLu6I","schema":{"providerType":"Snowflake","fields":[{"name":"CUSTOMER_ID","dataType":{"type":"Number"}},{"name":"FIRST_NAME","dataType":{"type":"String"}},{"name":"LAST_NAME","dataType":{"type":"String"}},{"name":"FIRST_ORDER","dataType":{"type":"Date"}},{"name":"MOST_RECENT_ORDER","dataType":{"type":"Date"}},{"name":"NUMBER_OF_ORDERS","dataType":{"type":"Number"}},{"name":"CUSTOMER_LIFETIME_VALUE","dataType":{"type":"Number"}}]},"slug":"CUSTOMERS"},{"id":"MyXMhyMtjt39XT9JlM0Hi$$FdT34X6KKgJyWLC0NWDnh","schema":{"providerType":"Snowflake","fields":[{"name":"ORDER_ID","dataType":{"type":"Number"}},{"name":"CUSTOMER_ID","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}},{"name":"STATUS","dataType":{"type":"String"}},{"name":"CREDIT_CARD_AMOUNT","dataType":{"type":"Number"}},{"name":"COUPON_AMOUNT","dataType":{"type":"Number"}},{"name":"BANK_TRANSFER_AMOUNT","dataType":{"type":"Number"}},{"name":"GIFT_CARD_AMOUNT","dataType":{"type":"Number"}},{"name":"AMOUNT","dataType":{"type":"Number"}}]},"slug":"ORDERS"}],"outputs":[{"id":"IvsfBF9LJaK99C9hRq_6a$$2R4PLNyT34A964cTUaJTe","schema":{"providerType":"Snowflake","fields":[{"name":"AMOUNT","dataType":{"type":"Number"}},{"name":"CUSTOMER_ID","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"Dd1OrW679GOSItNBX-GOY$$NWBogC9dQmSdoAoxs5Ot-":{"id":"Dd1OrW679GOSItNBX-GOY$$NWBogC9dQmSdoAoxs5Ot-","component":"Aggregate","metadata":{"label":"UserReport","slug":"UserReport","x":540,"y":220,"phase":0,"macroDependencies":[]},"properties":{"aggregate":[{"expression":{"expression":"sum(AMOUNT)"},"alias":"AMOUNT"},{"expression":{"expression":"max(ORDER_DATE)"},"alias":"LAST_ORDER_DATE"},{"expression":{"expression":"CUSTOMER_ID"},"alias":"CUSTOMER_ID"},{"expression":{"expression":"min(ORDER_DATE)"},"alias":"FIRST_ORDER_DATE"}],"allowSelection":true,"condition":{"expression":""},"activeTab":"aggregate","columnsSelector":["foj16x7NCdRiz06XsKTVI$$mTg7tGR-Mty_45YTznt07##CUSTOMER_ID","foj16x7NCdRiz06XsKTVI$$mTg7tGR-Mty_45YTznt07##AMOUNT","foj16x7NCdRiz06XsKTVI$$mTg7tGR-Mty_45YTznt07##ORDER_DATE"],"groupBy":[{"expression":{"expression":"CUSTOMER_ID"}}]},"ports":{"inputs":[{"id":"foj16x7NCdRiz06XsKTVI$$mTg7tGR-Mty_45YTznt07","schema":{"providerType":"Snowflake","fields":[{"name":"AMOUNT","dataType":{"type":"Number"}},{"name":"CUSTOMER_ID","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}}]},"slug":"in0"}],"outputs":[{"id":"G-CB8JuG_RMvvlM2bvTvT$$99c85Sgz2SpnzHGMGcKYC","schema":{"providerType":"Snowflake","fields":[{"name":"AMOUNT","dataType":{"type":"Number"}},{"name":"LAST_ORDER_DATE","dataType":{"type":"Date"}},{"name":"CUSTOMER_ID","dataType":{"type":"Number"}},{"name":"FIRST_ORDER_DATE","dataType":{"type":"Date"}}]},"slug":"out"}],"isCustomOutputSchema":false}}},"connections":[{"id":"sXqT2Pb3mUy8totR8Qt9L$$LNkh0mdjf4IyN6ZO-qKu5","source":"XDWCVKTc2tGc_ZEZ5EJ9l","sourcePort":"XCR3bpAElE7050s7VOXZx","target":"VWRtaocXXlJ5zC4wfU4_9$$ZI_8qrBqPI-d6yZJvs_r1","targetPort":"Fp4c9ib1g60lf9A8AxsQA$$_krT7e95lMUi6PmhvLu6I"},{"id":"eXL8enAxRIsPDQknTl9Bb$$OSf3JQl0sfXow5AO2BRws","source":"CI6hud1qAjis4uHAlURlY","sourcePort":"nFIZ6k2uj_lwIyvHcvauG","target":"VWRtaocXXlJ5zC4wfU4_9$$ZI_8qrBqPI-d6yZJvs_r1","targetPort":"MyXMhyMtjt39XT9JlM0Hi$$FdT34X6KKgJyWLC0NWDnh"},{"id":"xLgTORInDr2NSPL2NSxv5$$6WGvQx1ePEIWrTyl8UouQ","source":"VWRtaocXXlJ5zC4wfU4_9$$ZI_8qrBqPI-d6yZJvs_r1","sourcePort":"IvsfBF9LJaK99C9hRq_6a$$2R4PLNyT34A964cTUaJTe","target":"Dd1OrW679GOSItNBX-GOY$$NWBogC9dQmSdoAoxs5Ot-","targetPort":"foj16x7NCdRiz06XsKTVI$$mTg7tGR-Mty_45YTznt07"}],"component":"Model"}