{"id":"macro_tests","metainfo":{"label":"macro_tests","finalProcessID":"CeGvHh5N831aynY4I9J_b$$T8IYMAcVJTF2tnjrbzM5D","autoLayout":false,"staleState":"none","sourceSuggestions":{"sources":[]}},"processes":{"IEbt7s60nkavCMoApPAAY$$X7FEWn7DZ0Xi1Z4D81lf4":{"id":"IEbt7s60nkavCMoApPAAY$$X7FEWn7DZ0Xi1Z4D81lf4","component":"Join","metadata":{"label":"byOrder","slug":"byOrder","x":-400,"y":220,"phase":0,"macroDependencies":[]},"properties":{"conditions":[{"alias":"in1","expression":{"expression":"raw_payments.order_id = in1.id"},"joinType":"inner"}],"expressions":[{"expression":{"expression":"raw_payments.payment_method"},"alias":"payment_method"},{"expression":{"expression":"raw_payments.amount"},"alias":"amount"},{"expression":{"expression":"in1.order_date"},"alias":"order_date"},{"expression":{"expression":"in1.status"},"alias":"status"},{"expression":{"expression":"raw_payments.order_id"},"alias":"order_id"},{"expression":{"expression":"in1.user_id"},"alias":"user_id"}],"activeTab":"expressions","columnsSelector":["c1UIOw_3aFSFDDLu-VBIO$$F0_wl9QZ_NSLHh6nN6rgD##order_id","9fEEzX1yXGsI37oftvT3G$$wrT-1HZJFBj2USCeBy1Jo##id","c1UIOw_3aFSFDDLu-VBIO$$F0_wl9QZ_NSLHh6nN6rgD##payment_method","c1UIOw_3aFSFDDLu-VBIO$$F0_wl9QZ_NSLHh6nN6rgD##amount","9fEEzX1yXGsI37oftvT3G$$wrT-1HZJFBj2USCeBy1Jo##order_date","9fEEzX1yXGsI37oftvT3G$$wrT-1HZJFBj2USCeBy1Jo##status","c1UIOw_3aFSFDDLu-VBIO$$F0_wl9QZ_NSLHh6nN6rgD##order_id","9fEEzX1yXGsI37oftvT3G$$wrT-1HZJFBj2USCeBy1Jo##user_id"],"headAlias":"raw_payments"},"ports":{"inputs":[{"id":"c1UIOw_3aFSFDDLu-VBIO$$F0_wl9QZ_NSLHh6nN6rgD","schema":{"providerType":"Snowflake","fields":[{"name":"id","dataType":{"type":"Number"}},{"name":"order_id","dataType":{"type":"Number"}},{"name":"payment_method","dataType":{"type":"String"}},{"name":"amount","dataType":{"type":"Number"}}]},"slug":"raw_payments"},{"id":"9fEEzX1yXGsI37oftvT3G$$wrT-1HZJFBj2USCeBy1Jo","schema":{"providerType":"Snowflake","fields":[{"name":"id","dataType":{"type":"Number"}},{"name":"user_id","dataType":{"type":"Number"}},{"name":"order_date","dataType":{"type":"Date"}},{"name":"status","dataType":{"type":"String"}}]},"slug":"in1"}],"outputs":[{"id":"Y6A1DvaB0pYu5BW-_Apsx$$5LG9SkLenKZGlxVU_5HqP","schema":{"providerType":"Snowflake","fields":[{"name":"PAYMENT_METHOD","dataType":{"type":"String"}},{"name":"AMOUNT","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}},{"name":"STATUS","dataType":{"type":"String"}},{"name":"ORDER_ID","dataType":{"type":"Number"}},{"name":"USER_ID","dataType":{"type":"Number"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"jt2fecM_bepw9VBu9o_9Z$$wiS7sLa9biVfYefD_Prx4":{"id":"jt2fecM_bepw9VBu9o_9Z$$wiS7sLa9biVfYefD_Prx4","component":"Aggregate","metadata":{"label":"AmountByCustomer","slug":"AmountByCustomer","x":-60,"y":260,"phase":0,"macroDependencies":[]},"properties":{"aggregate":[{"expression":{"expression":"USER_ID"},"alias":"USER_ID"},{"expression":{"expression":"sum(AMOUNT)"},"alias":"AMOUNT"},{"expression":{"expression":"max(ORDER_DATE)"},"alias":"ORDER_DATE"},{"expression":{"expression":"ANY_VALUE(FULL_NAME)"},"alias":"FULL_NAME"}],"allowSelection":true,"condition":{"expression":""},"activeTab":"aggregate","columnsSelector":["Q3PFXRLMcbFsnFa30bujM$$EyMeLPeOZsVTfVnKXAXZC##USER_ID","Q3PFXRLMcbFsnFa30bujM$$EyMeLPeOZsVTfVnKXAXZC##AMOUNT","Q3PFXRLMcbFsnFa30bujM$$EyMeLPeOZsVTfVnKXAXZC##ORDER_DATE","Q3PFXRLMcbFsnFa30bujM$$EyMeLPeOZsVTfVnKXAXZC##FULL_NAME"],"groupBy":[{"expression":{"expression":"USER_ID"}}]},"ports":{"inputs":[{"id":"Q3PFXRLMcbFsnFa30bujM$$EyMeLPeOZsVTfVnKXAXZC","schema":{"providerType":"Snowflake","fields":[{"name":"USER_ID","dataType":{"type":"Number"}},{"name":"AMOUNT","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}},{"name":"FULL_NAME","dataType":{"type":"String"}},{"name":"AMOUNT_CENTS","dataType":{"type":"Number"}}]},"slug":"byCustomer"}],"outputs":[{"id":"OTlqqGwbUHxkStoBhwQ-Q$$NsVVeGYcyE0UScaPUgo70","schema":{"providerType":"Snowflake","fields":[{"name":"USER_ID","dataType":{"type":"Number"}},{"name":"AMOUNT","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}},{"name":"FULL_NAME","dataType":{"type":"String"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"mvT4Xo8evfj-yhV2ubodO":{"id":"mvT4Xo8evfj-yhV2ubodO","component":"Seed","metadata":{"label":"raw_payments","slug":"raw_payments","x":-560,"y":120,"phase":0},"properties":{"table":{"name":"raw_payments","sourceType":"Seed","alias":""}},"ports":{"inputs":[],"outputs":[{"id":"OycPPXphlcoU3ziAswiXd","schema":{"providerType":"Snowflake","fields":[{"name":"id","dataType":{"type":"Number"}},{"name":"order_id","dataType":{"type":"Number"}},{"name":"payment_method","dataType":{"type":"String"}},{"name":"amount","dataType":{"type":"Number"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"DUGW5w6NXvmXJGh-NicyD$$-W_D2FG4IS39pP4D_BBFN":{"id":"DUGW5w6NXvmXJGh-NicyD$$-W_D2FG4IS39pP4D_BBFN","component":"Join","metadata":{"label":"byCustomer","slug":"byCustomer","x":-220,"y":280,"phase":0,"macroDependencies":["dollars_to_cents"]},"properties":{"conditions":[{"alias":"in1","expression":{"expression":"in0.USER_ID = in1.id"},"joinType":"inner"}],"expressions":[{"expression":{"expression":"in0.USER_ID"},"alias":"USER_ID"},{"expression":{"expression":"in0.AMOUNT"},"alias":"AMOUNT"},{"expression":{"expression":"in0.ORDER_DATE"},"alias":"ORDER_DATE"},{"expression":{"expression":"CALCULATE_FULL_NAME(in1.first_name, '', in1.last_name)"},"alias":"full_name"},{"expression":{"expression":"{{ dollars_to_cents('in0.AMOUNT') }}"},"alias":"AMOUNT_CENTS"}],"activeTab":"expressions","columnsSelector":["5a_LVqa-4db7DJYD6fADB$$XGNrXn5eT9sWQvZJmlU-U##USER_ID","nRmiV_W2dyZpOU5_8aYZd$$4v6DrHVRh1sDdSKkzI9R8##id","5a_LVqa-4db7DJYD6fADB$$XGNrXn5eT9sWQvZJmlU-U##USER_ID","5a_LVqa-4db7DJYD6fADB$$XGNrXn5eT9sWQvZJmlU-U##AMOUNT","5a_LVqa-4db7DJYD6fADB$$XGNrXn5eT9sWQvZJmlU-U##ORDER_DATE","nRmiV_W2dyZpOU5_8aYZd$$4v6DrHVRh1sDdSKkzI9R8##first_name","nRmiV_W2dyZpOU5_8aYZd$$4v6DrHVRh1sDdSKkzI9R8##last_name"],"headAlias":"in0"},"ports":{"inputs":[{"id":"5a_LVqa-4db7DJYD6fADB$$XGNrXn5eT9sWQvZJmlU-U","schema":{"providerType":"Snowflake","fields":[{"name":"PAYMENT_METHOD","dataType":{"type":"String"}},{"name":"AMOUNT","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}},{"name":"STATUS","dataType":{"type":"String"}},{"name":"ORDER_ID","dataType":{"type":"Number"}},{"name":"USER_ID","dataType":{"type":"Number"}}]},"slug":"in0"},{"id":"nRmiV_W2dyZpOU5_8aYZd$$4v6DrHVRh1sDdSKkzI9R8","schema":{"providerType":"Snowflake","fields":[{"name":"id","dataType":{"type":"Number"}},{"name":"first_name","dataType":{"type":"String"}},{"name":"last_name","dataType":{"type":"String"}}]},"slug":"in1"}],"outputs":[{"id":"QBF8Mgjd_A4WpioHx6Rii$$xkpzeRTmkdKE8xoKMOo6P","schema":{"providerType":"Snowflake","fields":[{"name":"USER_ID","dataType":{"type":"Number"}},{"name":"AMOUNT","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}},{"name":"FULL_NAME","dataType":{"type":"String"}},{"name":"AMOUNT_CENTS","dataType":{"type":"Number"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"CeGvHh5N831aynY4I9J_b$$T8IYMAcVJTF2tnjrbzM5D":{"id":"CeGvHh5N831aynY4I9J_b$$T8IYMAcVJTF2tnjrbzM5D","component":"Macro","metadata":{"label":"add_audit_cols_1","slug":"add_audit_cols_1","x":100,"y":260,"phase":0,"macroDependencies":["jaffle_shop.add_audit_cols"]},"properties":{"macroName":"add_audit_cols","parameters":[{"name":"table_name","value":"'AmountByCustomer'"},{"name":"modified_by","value":"'ASHISH'"}],"projectName":"jaffle_shop"},"ports":{"inputs":[{"id":"kxwpLDWnEp6adnV40BhTc$$I1k44xHU2JyJP1m1Zj2Ed","schema":{"providerType":"Snowflake","fields":[{"name":"USER_ID","dataType":{"type":"Number"}},{"name":"AMOUNT","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}},{"name":"FULL_NAME","dataType":{"type":"String"}}]},"slug":"AmountByCustomer"}],"outputs":[{"id":"afkraSMFbhaTuOpBLcWZ9$$cuZUC7IpaUuiV6dCiT6zQ","schema":{"providerType":"Snowflake","fields":[{"name":"USER_ID","dataType":{"type":"Number"}},{"name":"AMOUNT","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}},{"name":"FULL_NAME","dataType":{"type":"String"}},{"name":"MODIFIED_ON","dataType":{"type":"Timestamp"}},{"name":"MODIFIED_BY","dataType":{"type":"String"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"XNa4QnBAFpBeNwg4oQAii":{"id":"XNa4QnBAFpBeNwg4oQAii","component":"Seed","metadata":{"label":"raw_orders","slug":"raw_orders","x":-580,"y":320,"phase":0},"properties":{"table":{"name":"raw_orders","sourceType":"Seed","alias":""}},"ports":{"inputs":[],"outputs":[{"id":"KCzantlkcunOuCE_qOhtM","schema":{"providerType":"Snowflake","fields":[{"name":"id","dataType":{"type":"Number"}},{"name":"user_id","dataType":{"type":"Number"}},{"name":"order_date","dataType":{"type":"Date"}},{"name":"status","dataType":{"type":"String"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"JFCxP4_8-t0iATZ98y1PN":{"id":"JFCxP4_8-t0iATZ98y1PN","component":"Seed","metadata":{"label":"raw_customers","slug":"raw_customers","x":-380,"y":440,"phase":0},"properties":{"table":{"name":"raw_customers","sourceType":"Seed","alias":""}},"ports":{"inputs":[],"outputs":[{"id":"g49cMRVW-JpdaTpZ2MPbl","schema":{"providerType":"Snowflake","fields":[{"name":"id","dataType":{"type":"Number"}},{"name":"first_name","dataType":{"type":"String"}},{"name":"last_name","dataType":{"type":"String"}}]},"slug":"out"}],"isCustomOutputSchema":false}}},"connections":[{"id":"UHa1lgqbO5uLx-l08yY7W$$W6pZqumZIvjRW8CHsoIJV","source":"mvT4Xo8evfj-yhV2ubodO","sourcePort":"OycPPXphlcoU3ziAswiXd","target":"IEbt7s60nkavCMoApPAAY$$X7FEWn7DZ0Xi1Z4D81lf4","targetPort":"c1UIOw_3aFSFDDLu-VBIO$$F0_wl9QZ_NSLHh6nN6rgD"},{"id":"idmsWMvp-exisO2qcqqSA","source":"XNa4QnBAFpBeNwg4oQAii","sourcePort":"KCzantlkcunOuCE_qOhtM","target":"IEbt7s60nkavCMoApPAAY$$X7FEWn7DZ0Xi1Z4D81lf4","targetPort":"9fEEzX1yXGsI37oftvT3G$$wrT-1HZJFBj2USCeBy1Jo"},{"id":"1fFqq51vPPK0KLYFTOzEg$$4lIGW_9ZYMStv0Sm-jkpA","source":"JFCxP4_8-t0iATZ98y1PN","sourcePort":"g49cMRVW-JpdaTpZ2MPbl","target":"DUGW5w6NXvmXJGh-NicyD$$-W_D2FG4IS39pP4D_BBFN","targetPort":"nRmiV_W2dyZpOU5_8aYZd$$4v6DrHVRh1sDdSKkzI9R8"},{"id":"Vx1ZQEuc_CZVJF-mxnjMd","source":"IEbt7s60nkavCMoApPAAY$$X7FEWn7DZ0Xi1Z4D81lf4","sourcePort":"Y6A1DvaB0pYu5BW-_Apsx$$5LG9SkLenKZGlxVU_5HqP","target":"DUGW5w6NXvmXJGh-NicyD$$-W_D2FG4IS39pP4D_BBFN","targetPort":"5a_LVqa-4db7DJYD6fADB$$XGNrXn5eT9sWQvZJmlU-U"},{"id":"tYGueesLuIwYkB0ArqcTw$$HrAyeFs1DNCMLFN0LxOYi","source":"DUGW5w6NXvmXJGh-NicyD$$-W_D2FG4IS39pP4D_BBFN","sourcePort":"QBF8Mgjd_A4WpioHx6Rii$$xkpzeRTmkdKE8xoKMOo6P","target":"jt2fecM_bepw9VBu9o_9Z$$wiS7sLa9biVfYefD_Prx4","targetPort":"Q3PFXRLMcbFsnFa30bujM$$EyMeLPeOZsVTfVnKXAXZC"},{"id":"KPYL28SatD88sViVFKm3r","source":"jt2fecM_bepw9VBu9o_9Z$$wiS7sLa9biVfYefD_Prx4","sourcePort":"OTlqqGwbUHxkStoBhwQ-Q$$NsVVeGYcyE0UScaPUgo70","target":"CeGvHh5N831aynY4I9J_b$$T8IYMAcVJTF2tnjrbzM5D","targetPort":"kxwpLDWnEp6adnV40BhTc$$I1k44xHU2JyJP1m1Zj2Ed"}],"component":"Model"}