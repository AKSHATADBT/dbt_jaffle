{"id":"customers","metainfo":{"label":"customers","autoLayout":true,"staleState":"none","sourceSuggestions":{"sources":[]},"graphConfig":{"userDefinedConfig":{"vars":{}}}},"processes":{"customers##SjG4uTyN":{"id":"customers##SjG4uTyN","component":"Model","metadata":{"label":"customers","phase":0},"properties":{"table":{"name":"stg_customers","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"GoXEOfTx","slug":"out"}],"isCustomOutputSchema":false}},"orders##smgl17a7":{"id":"orders##smgl17a7","component":"Model","metadata":{"label":"orders","phase":0},"properties":{"table":{"name":"stg_orders","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"ECFQDhwZ","slug":"out"}],"isCustomOutputSchema":false}},"final_with_order##GAtEoafb":{"id":"final_with_order##GAtEoafb","component":"OrderBy","metadata":{"label":"final_with_order","phase":0,"macroDependencies":[]},"properties":{"columnsSelector":[],"orders":[{"expression":{"expression":"total_orders"},"sortType":"desc"}]},"ports":{"inputs":[{"id":"tyJi45Cp","slug":"customer_report"}],"outputs":[{"id":"sN15hpcU","slug":"out"}],"isCustomOutputSchema":false}},"customer_payments##TVj11fvg":{"id":"customer_payments##TVj11fvg","component":"Join","metadata":{"label":"customer_payments","phase":0,"macroDependencies":[]},"properties":{"conditions":[{"alias":"orders","expression":{"expression":"payments.order_id = orders.order_id"},"joinType":"LEFT"}],"expressions":[{"expression":{"expression":"orders.customer_id"},"alias":"customer_id"},{"expression":{"expression":"amount"}}],"activeTab":"conditions","columnsSelector":[],"headAlias":"payments"},"ports":{"inputs":[{"id":"OqoGluVN","slug":"payments"},{"id":"zZwtfCDv","slug":"orders"}],"outputs":[{"id":"t1fhdgBL","slug":"out"}],"isCustomOutputSchema":false}},"customers##EBUIR7s3":{"id":"customers##EBUIR7s3","component":"TargetModel","metadata":{"label":"customers","phase":0,"macroDependencies":[]},"properties":{"customQueryDisabled":true,"customQuery":false,"incrementalEditorDisabled":true,"query":"SELECT * \n\nFROM final_with_order\n","incrementalKey":false,"incremental":{"expression":"true"}},"ports":{"inputs":[{"id":"jOuvGI1H","slug":"final_with_order"}],"outputs":[{"id":"HXzd5kEO","slug":"out"}],"isCustomOutputSchema":false}},"customer_orders##qeS5dkMc":{"id":"customer_orders##qeS5dkMc","component":"Aggregate","metadata":{"label":"customer_orders","phase":0,"macroDependencies":[]},"properties":{"aggregate":[{"expression":{"expression":"customer_id"}},{"expression":{"expression":"min(order_date)"},"alias":"first_order"},{"expression":{"expression":"max(order_date)"},"alias":"most_recent_order"},{"expression":{"expression":"count(order_id)"},"alias":"number_of_orders"}],"allowSelection":true,"condition":{"expression":""},"activeTab":"aggregate","columnsSelector":[],"groupBy":[{"expression":{"expression":"customer_id"}}]},"ports":{"inputs":[{"id":"jfay2mze","slug":"orders"}],"outputs":[{"id":"K4TIOoxl","slug":"out"}],"isCustomOutputSchema":false}},"amount_per_customer##aVbEjYrv":{"id":"amount_per_customer##aVbEjYrv","component":"Aggregate","metadata":{"label":"amount_per_customer","phase":0,"macroDependencies":[]},"properties":{"aggregate":[{"expression":{"expression":"customer_id"}},{"expression":{"expression":"sum(amount)"},"alias":"total_amount"}],"allowSelection":true,"condition":{"expression":""},"activeTab":"aggregate","columnsSelector":[],"groupBy":[{"expression":{"expression":"customer_id"}}]},"ports":{"inputs":[{"id":"mWZtsGk9","slug":"customer_payments"}],"outputs":[{"id":"s7vbulL7","slug":"out"}],"isCustomOutputSchema":false}},"customer_report##d0j5wuNn":{"id":"customer_report##d0j5wuNn","component":"Join","metadata":{"label":"customer_report","phase":0,"macroDependencies":[]},"properties":{"conditions":[{"alias":"customer_orders","expression":{"expression":"customers.customer_id = customer_orders.customer_id"},"joinType":"LEFT"},{"alias":"amount_per_customer","expression":{"expression":"customers.customer_id = amount_per_customer.customer_id"},"joinType":"LEFT"}],"expressions":[{"expression":{"expression":"customers.customer_id"}},{"expression":{"expression":"customers.first_name"}},{"expression":{"expression":"customers.last_name"}},{"expression":{"expression":"customer_orders.first_order"}},{"expression":{"expression":"customer_orders.most_recent_order"}},{"expression":{"expression":"customer_orders.number_of_orders"},"alias":"total_orders"},{"expression":{"expression":"amount_per_customer.total_amount"},"alias":"customer_lifetime_value"}],"activeTab":"conditions","columnsSelector":[],"headAlias":"customers"},"ports":{"inputs":[{"id":"nw6KiYD8","slug":"customers"},{"id":"KnQIsvXr","slug":"customer_orders"},{"id":"XpI8SOLr","slug":"amount_per_customer"}],"outputs":[{"id":"iUxFG0pL","slug":"out"}],"isCustomOutputSchema":false}},"payments##aqTjI2PV":{"id":"payments##aqTjI2PV","component":"Model","metadata":{"label":"payments","phase":0},"properties":{"table":{"name":"stg_payments","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"HGtsa92J","slug":"out"}],"isCustomOutputSchema":false}}},"connections":[{"id":"TKobdg1P","source":"payments##aqTjI2PV","sourcePort":"HGtsa92J","target":"customer_payments##TVj11fvg","targetPort":"OqoGluVN"},{"id":"RkzMUn5A","source":"orders##smgl17a7","sourcePort":"ECFQDhwZ","target":"customer_payments##TVj11fvg","targetPort":"zZwtfCDv"},{"id":"WrUWJSlz","source":"customer_payments##TVj11fvg","sourcePort":"t1fhdgBL","target":"amount_per_customer##aVbEjYrv","targetPort":"mWZtsGk9"},{"id":"z864xmMC","source":"orders##smgl17a7","sourcePort":"ECFQDhwZ","target":"customer_orders##qeS5dkMc","targetPort":"jfay2mze"},{"id":"u0o4vlM8","source":"customers##SjG4uTyN","sourcePort":"GoXEOfTx","target":"customer_report##d0j5wuNn","targetPort":"nw6KiYD8"},{"id":"JRCzmSE0","source":"customer_orders##qeS5dkMc","sourcePort":"K4TIOoxl","target":"customer_report##d0j5wuNn","targetPort":"KnQIsvXr"},{"id":"g8D1bvrj","source":"amount_per_customer##aVbEjYrv","sourcePort":"s7vbulL7","target":"customer_report##d0j5wuNn","targetPort":"XpI8SOLr"},{"id":"ymxU7V9x","source":"customer_report##d0j5wuNn","sourcePort":"iUxFG0pL","target":"final_with_order##GAtEoafb","targetPort":"tyJi45Cp"},{"id":"CqUzVokB","source":"final_with_order##GAtEoafb","sourcePort":"sN15hpcU","target":"customers##EBUIR7s3","targetPort":"jOuvGI1H"}],"component":"Model"}