{"id":"customers","metainfo":{"label":"customers","finalProcessID":"final_with_order##iIXTI6Jy","autoLayout":true,"staleState":"none","sourceSuggestions":{"sources":[]},"graphConfig":{"userDefinedConfig":{"vars":{}}}},"processes":{"final_with_order##iIXTI6Jy":{"id":"final_with_order##iIXTI6Jy","component":"OrderBy","metadata":{"label":"final_with_order","phase":0,"macroDependencies":[]},"properties":{"columnsSelector":[],"orders":[{"expression":{"expression":"total_orders"},"sortType":"desc"}]},"ports":{"inputs":[{"id":"rzrmyiGi","slug":"customer_report"}],"outputs":[{"id":"JIDayMLp","slug":"out"}],"isCustomOutputSchema":false}},"orders##5zzCzVh4":{"id":"orders##5zzCzVh4","component":"Model","metadata":{"label":"orders","phase":0,"macroDependencies":[]},"properties":{"table":{"name":"stg_orders","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"rrrDGCJT","slug":"out"}],"isCustomOutputSchema":false}},"customer_report##E1S8NRPf":{"id":"customer_report##E1S8NRPf","component":"Join","metadata":{"label":"customer_report","phase":0,"macroDependencies":[]},"properties":{"conditions":[{"alias":"customer_orders","expression":{"expression":"customers.customer_id = customer_orders.customer_id"},"joinType":"LEFT"},{"alias":"amount_per_customer","expression":{"expression":"customers.customer_id = amount_per_customer.customer_id"},"joinType":"LEFT"}],"expressions":[{"expression":{"expression":"customers.customer_id"}},{"expression":{"expression":"customers.first_name"}},{"expression":{"expression":"customers.last_name"}},{"expression":{"expression":"customer_orders.first_order"}},{"expression":{"expression":"customer_orders.most_recent_order"}},{"expression":{"expression":"customer_orders.number_of_orders"},"alias":"total_orders"},{"expression":{"expression":"amount_per_customer.total_amount"},"alias":"customer_lifetime_value"}],"activeTab":"conditions","columnsSelector":[],"headAlias":"customers"},"ports":{"inputs":[{"id":"lUTl9B6w","slug":"customers"},{"id":"8PJ9ekPR","slug":"customer_orders"},{"id":"hcmspGIj","slug":"amount_per_customer"}],"outputs":[{"id":"3m8Ygupq","slug":"out"}],"isCustomOutputSchema":false}},"payments##7hCRkw95":{"id":"payments##7hCRkw95","component":"Model","metadata":{"label":"payments","phase":0,"macroDependencies":[]},"properties":{"table":{"name":"stg_payments","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"6S7S08y4","slug":"out"}],"isCustomOutputSchema":false}},"customer_orders##wRxyUdRE":{"id":"customer_orders##wRxyUdRE","component":"Aggregate","metadata":{"label":"customer_orders","phase":0,"macroDependencies":[]},"properties":{"aggregate":[{"expression":{"expression":"customer_id"}},{"expression":{"expression":"min(order_date)"},"alias":"first_order"},{"expression":{"expression":"max(order_date)"},"alias":"most_recent_order"},{"expression":{"expression":"count(order_id)"},"alias":"number_of_orders"}],"allowSelection":true,"activeTab":"aggregate","columnsSelector":[],"groupBy":[{"expression":{"expression":"customer_id"}}]},"ports":{"inputs":[{"id":"5rvGm5b7","slug":"orders"}],"outputs":[{"id":"5w1nPKtD","slug":"out"}],"isCustomOutputSchema":false}},"customers##llgy382P":{"id":"customers##llgy382P","component":"Model","metadata":{"label":"customers","phase":0,"macroDependencies":[]},"properties":{"table":{"name":"stg_customers","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"hal5ig6L","slug":"out"}],"isCustomOutputSchema":false}},"amount_per_customer##WcmVXU5d":{"id":"amount_per_customer##WcmVXU5d","component":"Aggregate","metadata":{"label":"amount_per_customer","phase":0,"macroDependencies":[]},"properties":{"aggregate":[{"expression":{"expression":"customer_id"}},{"expression":{"expression":"sum(amount)"},"alias":"total_amount"}],"allowSelection":true,"activeTab":"aggregate","columnsSelector":[],"groupBy":[{"expression":{"expression":"customer_id"}}]},"ports":{"inputs":[{"id":"ctFKWYhU","slug":"customer_payments"}],"outputs":[{"id":"6zpgZNza","slug":"out"}],"isCustomOutputSchema":false}},"customer_payments##uOKLV87J":{"id":"customer_payments##uOKLV87J","component":"Join","metadata":{"label":"customer_payments","phase":0,"macroDependencies":[]},"properties":{"conditions":[{"alias":"orders","expression":{"expression":"payments.order_id = orders.order_id"},"joinType":"LEFT"}],"expressions":[{"expression":{"expression":"orders.customer_id"},"alias":"customer_id"},{"expression":{"expression":"amount"}}],"activeTab":"conditions","columnsSelector":[],"headAlias":"payments"},"ports":{"inputs":[{"id":"YP5yfuzP","slug":"payments"},{"id":"i91QHou8","slug":"orders"}],"outputs":[{"id":"xVccf1W3","slug":"out"}],"isCustomOutputSchema":false}}},"connections":[{"id":"047GCXU6","source":"payments##7hCRkw95","sourcePort":"6S7S08y4","target":"customer_payments##uOKLV87J","targetPort":"YP5yfuzP"},{"id":"ZMI7ZU7x","source":"orders##5zzCzVh4","sourcePort":"rrrDGCJT","target":"customer_payments##uOKLV87J","targetPort":"i91QHou8"},{"id":"1N7cEJMy","source":"customer_payments##uOKLV87J","sourcePort":"xVccf1W3","target":"amount_per_customer##WcmVXU5d","targetPort":"ctFKWYhU"},{"id":"ZtBPc4Yn","source":"orders##5zzCzVh4","sourcePort":"rrrDGCJT","target":"customer_orders##wRxyUdRE","targetPort":"5rvGm5b7"},{"id":"S5lEUdF5","source":"customers##llgy382P","sourcePort":"hal5ig6L","target":"customer_report##E1S8NRPf","targetPort":"lUTl9B6w"},{"id":"Z7JG8Vdh","source":"customer_orders##wRxyUdRE","sourcePort":"5w1nPKtD","target":"customer_report##E1S8NRPf","targetPort":"8PJ9ekPR"},{"id":"pxkHDKag","source":"amount_per_customer##WcmVXU5d","sourcePort":"6zpgZNza","target":"customer_report##E1S8NRPf","targetPort":"hcmspGIj"},{"id":"7m9VUDfn","source":"customer_report##E1S8NRPf","sourcePort":"3m8Ygupq","target":"final_with_order##iIXTI6Jy","targetPort":"rzrmyiGi"}],"component":"Model"}